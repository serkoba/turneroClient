<!DOCTYPE html>

<html>

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width" />
    
    <!-- Good default declaration:
    * gap: is required only on iOS (when using UIWebView) and is needed for JS->native communication
    * https://ssl.gstatic.com is required only on Android and is needed for TalkBack to function properly
    * Disables use of eval() and inline scripts in order to mitigate risk of XSS vulnerabilities. To change this:
        * Enable inline JS: add 'unsafe-inline' to default-src
        * Enable eval(): add 'unsafe-eval' to default-src
    * Create your own at http://cspisawesome.com
    -->
    <!-- <meta http-equiv="Content-Security-Policy" content="default-src 'self' data: gap: 'unsafe-inline' https://ssl.gstatic.com; style-src 'self' 'unsafe-inline'; media-src *" /> -->

    
    <link rel="stylesheet" href="css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="css/index.css" />
    <script type="text/javascript" src="cordova.js"></script>
    <script type="text/javascript" src="js/PushNotification.js"></script>
    <script type="text/javascript" src="js/index.js"></script>
    <script type="text/javascript" src="js/jquery-3.1.1.min.js"></script>
    <script type="text/javascript" src="js/bootstrap.min.js"></script>
    
</head>

<body>

    <input type="hidden" id="gcm_id" />
    
    <div class="container-fluid">
        <div class="row">
            <div class="col-md-6 col-md-offset-3">
                
                <h3>Seleccione una sede:</h3>
                  <select id="slcSucursal" class="form-control">
                    <option value="1">Bahía Transporte Sapem</option>
                    <option value="2">Hall del palacio comunal</option>
                    <option value="3">Mercado Municipal</option>
                    <option value="4">Delegación Municipal de Ingeniero White</option>
                    <option value="5">Biblioteca Popular José Hernández de General Cerri</option>
                    <option value="6">Terminal de ómnibus</option>
                    <option value="7">Puesto en peatonal Drago esquina Colón</option>
                    <option value="8">Sociedad de Fomento B° Victoria Sinclair</option>
                </select>
                <br>
                <h3>Ingrese su turno:</h3>
                <div class="DivTurno">
                    <input type="number" class="form-control" id="txtNumber" placeholder="Turno" aria-describedby="basic-addon1">
                    <button class="btn btn-lg btn-success" type="button" id="btnSetNumber">Enviar turno</button>
                </div>

                <div id="tunero">
                    <p id="textTurnero">--</p>
                </div>

                <img src="img/logo_rosa.png"/>
                <img src="img/m.png"/>

            </div>
        </div>                    
    </div>

    <script type="text/javascript">
        app.initialize();
        LoadData();
      
        $("#slcSucursal").change(function () {
            ChangeNumberTurn($("#textTurnero"));


        });

        $("#btnSetNumber").click(function () {
            var deviceID = device.uuid;
            var stringUri = "  http://bahiatransporte.com.ar/turnos/usuarios.php?gcm_id=" + $("#gcm_id").text() + "&id_punto_de_venta=" + $("#slcSucursal").val() + "&turno=" + $("#txtNumber").val() + "&deviceID="+deviceID;
            console.log('enviando solicitud...');
            console.log(stringUri);
            $("#btnSetNumber").text("Enviando turno...");
            $.getJSON(stringUri, function (data) {
                $.each(data, function (i, item) {
                    
                    if (item == '-1') {
                        $("#btnSetNumber").text("Turno guardado.");
                    }
                })

            })
            .fail(function (jqXHR, textStatus, errorThrown) { console.log(errorThrown); })
            .always(function () {
                localStorage.setItem("turno", $("#txtNumber").val());
                localStorage.setItem("sucursal", $("#slcSucursal").val());
                

            });
        });
     
    </script>
</body>

</html>